# message-persistence-service
Crude Work in Progress!

## Dependencies
Go
docker
docker-compose

## Data model
https://github.com/gitstreamio/gitstream/blob/master/data_model.md

## Usage
### Build
Just enter the project directory and type

    ./docker-build.sh

### Run
Just enter the project directory and type

    docker-compose up

The service is now running on port `2021`
ES is running on port `9200`
### Writing

#### Create a message
    curl -X POST -d '{"author":"dino", "body":"Hallo"}' localhost:2021/someorga/somerepo
This will return the id of the created message

#### Update a message
The id is required. (Its the id autogenerated by elasticsearch, get it by querying ES)

    curl -X UPDATE -d '{"user":"dino", "message":"Hallo"}' localhost:2021/someorga/somerepo/someid

#### Delete a message
The id is required.

    curl -X UPDATE localhost:2021/someorga/somerepo/someid


### Reading
#### By id
You can currently get a message with a specific id with

    curl -X GET localhost:2021/someorga{/someoptionalrepo}/~someid

#### Get a timeline

    curl -X GET localhost:2021/someorga{/someoptionalrepo}
